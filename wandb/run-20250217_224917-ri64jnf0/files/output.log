Epoch 1/10:   0%|                                                                                                     | 0/1104 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/teamspace/studios/this_studio/ileri_sayisal/train_hf.py", line 178, in <module>
    finetuner.train(train_loader, val_loader)
  File "/teamspace/studios/this_studio/ileri_sayisal/train_hf.py", line 70, in train
    for batch in pbar:
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/_utils.py", line 722, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/teamspace/studios/this_studio/ileri_sayisal/dataset.py", line 158, in __getitem__
    sample = self.transform(sample)
  File "/teamspace/studios/this_studio/ileri_sayisal/dataset.py", line 305, in __call__
    inputs = self.processor(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/processing_sam.py", line 110, in __call__
    encoding_image_processor = self.image_processor(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/image_processing_utils.py", line 42, in __call__
    return self.preprocess(images, **kwargs)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/utils/generic.py", line 854, in wrapper
    return func(*args, **valid_kwargs)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 523, in preprocess
    images, original_sizes, reshaped_input_sizes = zip(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 525, in <genexpr>
    self._preprocess_image(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 330, in _preprocess_image
    image, reshaped_input_size = self._preprocess(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 279, in _preprocess
    image = self.resize(image=image, size=size, resample=resample, input_data_format=input_data_format)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 254, in resize
    return resize(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/image_transforms.py", line 369, in resize
    do_rescale = _rescale_for_pil_conversion(image)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/image_transforms.py", line 151, in _rescale_for_pil_conversion
    raise ValueError(
ValueError: The image to be converted to a PIL image contains values outside the range [0, 1], got [-1.0, 1.0] which cannot be converted to uint8.

Traceback (most recent call last):
  File "/teamspace/studios/this_studio/ileri_sayisal/train_hf.py", line 178, in <module>
    finetuner.train(train_loader, val_loader)
  File "/teamspace/studios/this_studio/ileri_sayisal/train_hf.py", line 70, in train
    for batch in pbar:
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/_utils.py", line 722, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/teamspace/studios/this_studio/ileri_sayisal/dataset.py", line 158, in __getitem__
    sample = self.transform(sample)
  File "/teamspace/studios/this_studio/ileri_sayisal/dataset.py", line 305, in __call__
    inputs = self.processor(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/processing_sam.py", line 110, in __call__
    encoding_image_processor = self.image_processor(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/image_processing_utils.py", line 42, in __call__
    return self.preprocess(images, **kwargs)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/utils/generic.py", line 854, in wrapper
    return func(*args, **valid_kwargs)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 523, in preprocess
    images, original_sizes, reshaped_input_sizes = zip(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 525, in <genexpr>
    self._preprocess_image(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 330, in _preprocess_image
    image, reshaped_input_size = self._preprocess(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 279, in _preprocess
    image = self.resize(image=image, size=size, resample=resample, input_data_format=input_data_format)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/models/sam/image_processing_sam.py", line 254, in resize
    return resize(
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/image_transforms.py", line 369, in resize
    do_rescale = _rescale_for_pil_conversion(image)
  File "/home/zeus/miniconda3/envs/cloudspace/lib/python3.10/site-packages/transformers/image_transforms.py", line 151, in _rescale_for_pil_conversion
    raise ValueError(
ValueError: The image to be converted to a PIL image contains values outside the range [0, 1], got [-1.0, 1.0] which cannot be converted to uint8.
